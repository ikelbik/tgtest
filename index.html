<!DOCTYPE html>
<html>
<head>
    <meta name="telegram:verify" content="VERIFICATION_CODE_OT_BOTFATHER">
    <link rel="manifest" href="/app-manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000022">
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>
    <style>
        * { margin: 0; padding: 0; overflow: hidden; -webkit-tap-highlight-color: transparent; touch-action: none }
        body { background: #000022 }
    </style>
</head>
<body>
    <div id="game"></div>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        const isTelegram = /Telegram/.test(navigator.userAgent);
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.show();

        class MainScene extends Phaser.Scene {
            constructor() {
                super();
                this.coins = [];
                this.rotSpeed = isTelegram ? 0.005 : 0.01;
                this.scaleFactor = 0.001;
                this.isDragging = false;
            }
			


            preload() {
                this.load.setBaseURL('https://ikelbik.github.io/tgtest');
                this.load.image('bg', 'assets/wtf.png');
                this.load.obj('coin', 'assets/fantom.obj');
                this.load.image('texture', 'assets/coin_txt.png');
            }

            create() {
    const { centerX, centerY } = this.cameras.main;
    
    // Параметры стопки
    const stackHeight = 7;
    const yOffset = 0.05; // Смещение в пикселях между монетами
    const baseScale = 0.5; // Базовый масштаб для всех монет

    for (let i = 0; i < stackHeight; i++) {
        const coin = this.add.mesh(
            centerX, // X позиция (центр экрана)
            centerY - i * yOffset, // Y позиция со смещением
            'texture'
        );
        
        // Инициализация меша
        coin.addVerticesFromObj('coin', 0.1)
            .resetTransform() // Сброс текущих трансформаций
            .setScale(baseScale) // Фиксированный масштаб
            .panZ(7) // Фиксированная позиция по Z
            .modelRotation.y = Phaser.Math.FloatBetween(0, Math.PI*2);
        
        this.coins.push(coin);
    }

}


        }

const config = {
    type: Phaser.WEBGL,
    width: window.innerWidth,
    height: window.innerHeight,
    parent: 'game',
    scene: MainScene,
    // Добавляем здесь настройки камеры ▼
    cameras: {
        default: {
        type: 'OrthographicCamera',
        zoom: 1,
        near: -1000, // Отрицательное near
        far: 1000,
        position: { x:0, y:0, z:100 }
        }
    },

    scale: { 
        mode: Phaser.Scale.RESIZE, 
        autoCenter: Phaser.Scale.CENTER_BOTH 
    },
    input: { 
        activePointers: 2 
    },
    fps: { 
        target: 60, 
        smoothStep: true 
    },
    render: { 
        antialiasGL: true 
    }
};

        const game = new Phaser.Game(config);
        window.addEventListener('resize', () => game.scale.resize(window.innerWidth, window.innerHeight));
        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
</html>